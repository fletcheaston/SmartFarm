<!DOCTYPE html>
<html lang="en">

	<head>
		<title>SmartFarm Web IDE v1.0</title>
        <link rel="stylesheet" href="CSS/ide.css">
        <link rel="stylesheet" href="CSS/select.css">

    </head>

    <body class="body" onload="onPageLoad()">

        <div class="center_title">

            <h1>
                SmartFarm DAQ Web IDE
            </h1>
        </div>

        <hr>

        <div class="container nav">
            <a href="home.html" class="area_button">Home</a>

            <a href="graphic_ide.html" class="area_button">Graphic Ide</a>

            <a href="text_ide.html" class="area_button area_button_selected">Text Ide</a>

            <a href="faq.html" class="area_button">FAQ</a>
        </div>

        <hr>

        <div class="container editor" id="editor">
/*
     _____          ____            __   ___
    |  __ \   /\   / __ \          / /  |__ \
    | |  | | /  \ | |  | | __   __/ /_     ) |
    | |  | |/ /\ \| |  | | \ \ / / '_ \   / /
    | |__| / ____ \ |__| |  \ V /| (_) | / /_
    |_____/_/    \_\___\_\   \_/  \___(_)____|

*/

</div>

        <hr>

    </body>

    <script src="JS/ace/ace.js" type="text/javascript" charset="utf-8"></script>
    <script>

        function onPageLoad()
        {
            createAceEditor();
            loadDataForEditor();
        }

        function createAceEditor()
        {
            var fontSize = 16;
            var editor = ace.edit("editor");
            editor.setTheme("ace/theme/terminal");
            editor.session.setMode("ace/mode/c_cpp");
            document.getElementById("editor").style.fontSize=fontSize.toString() + "px";
            editor.resize(true);
        }

        function loadDataForEditor()
        {
            var board = JSON.parse(localStorage.getItem("SmartFarmBoard"));

            var timestamp = 'BoardID + " TS " + smf.timeStamp()';
            var volts = 'BoardID + " V " + smf.readVolts()';
            var portA = loadPortA(board.portA);
            var portB = loadPortB(board.portB);
            var portC = loadPortC(board.portC);
            var portD1 = loadPortD1(board.portD1);
            var portD2 = loadPortD2(board.portD2);
            var portD3 = loadPortD3(board.portD3);
            var portD4 = loadPortD4(board.portD4);
            var portD5 = loadPortD5(board.portD5);
            var portD6 = loadPortD6(board.portD6);
            var portD7 = loadPortD7(board.portD7);
            var portD8 = loadPortD8(board.portD8);
            var portE = loadPortE(board.portE);
            var portF = loadPortE(board.portF);
            var SDCard = board.SDCard;

            var ports = [volts, portA, portB, portC, portD1, portD2, portD3, portD4, portD5, portD6, portD7, portD8, portE, portF];

            var editorText = '#include <SmartFarmMeasureDAQv6_2.h>\n\nSmartFarmMeasure smf;\n\nvoid setup()\n{\n    String BoardID = "A";\n\n    smf.finishUp();\n    Serial.begin(57600);\n    Wire.begin();\n\n    smf.setupAll();\n\n';

            for(var i = 0;i < ports.length;i++)
            {
                if(ports[i] != null)
                {
                    var serialPrint = "    Serial.println(" + ports[i] + ");\n";
                    editorText += serialPrint;
                }
            }

            editorText += "\n    Serial.flush();\n    Serial.end();\n    delay(2000);\n\n";

            if(SDCard === "MicroSD")
            {
                
                var serialPrint = "    smf.write2SD(" + timestamp + ");\n";
                editorText += serialPrint;

                for(var i = 0;i < ports.length;i++)
                {
                    if(ports[i] != null)
                    {
                        var serialPrint = "    smf.write2SD(" + ports[i] + ");\n";
                        editorText += serialPrint;
                    }
                }
            }

            editorText += "}\n\nvoid loop()\n{\n    //Nothing to loop through\n}\n";

            ace.edit("editor").gotoLine(12);
            ace.edit("editor").insert(editorText);
        }

        function loadPortA(sensor)
        {
            var portA = 'BoardID + " A " + ';

            if(sensor === "SDI12 (Decagon)" || sensor === "SDI12 (Rugged Decagon)")
            {
                portA += "smf.readDecSensors()";
                return(portA);
            }

            return(null);
        }

        function loadPortB(sensor)
        {
            var portB = 'BoardID + " B " + ';

            /*if(sensor === )
            {
                portB += "smf.function()";
                return(portB);
            }*/

            return(null);
        }

        function loadPortC(sensor)
        {
            var portC = 'BoardID + " C " + ';

            /*if(sensor === )
            {
                portC += "smf.function()";
                return(portC);
            }*/

            return(null);
        }

        function loadPortD1(sensor)
        {
            var portD1 = 'BoardID + " D1 " + ';

            if(sensor === "Watermark Resistor")
            {
                portD1 += "smf.readWM(1)";
                return(portD1);
            }

            return(null);
        }

        function loadPortD2(sensor)
        {
            var portD2 = 'BoardID + " D2 " + ';

            if(sensor === "Watermark Resistor")
            {
                portD2 += "smf.readWM(2)";
                return(portD2);
            }

            return(null);
        }

        function loadPortD3(sensor)
        {
            var portD3 = 'BoardID + " D3 " + ';

            if(sensor === "Watermark Resistor")
            {
                portD3 += "smf.readWM(3)";
                return(portD3);
            }

            return(null);
        }

        function loadPortD4(sensor)
        {
            var portD4 = 'BoardID + " D4 " + ';

            if(sensor === "Watermark Resistor")
            {
                portD4 += "smf.readWM(4)";
                return(portD4);
            }

            return(null);
        }

        function loadPortD5(sensor)
        {
            var portD5 = 'BoardID + " D5 " + ';

            if(sensor === "Watermark Resistor")
            {
                portD5 += "smf.readWM(5)";
                return(portD5);
            }

            return(null);
        }

        function loadPortD6(sensor)
        {
            var portD6 = 'BoardID + " D6 " + ';

            if(sensor === "Watermark Resistor")
            {
                portD6 += "smf.readWM(6)";
                return(portD6);
            }

            return(null);
        }

        function loadPortD7(sensor)
        {
            var portD7 = 'BoardID + " D7 " + ';

            if(sensor === "Watermark Resistor")
            {
                portD7 += "smf.readWM(7)";
                return(portD7);
            }

            return(null);
        }

        function loadPortD8(sensor)
        {
            var portD8 = 'BoardID + " D8 " + ';

            if(sensor === "Watermark Resistor")
            {
                portD8 += "smf.readWM(8)";
                return(portD8);
            }

            return(null);
        }

        function loadPortE(sensor)
        {
            var portE = 'BoardID + " E " + ';

            if(sensor === "Temperature")
            {
                portE += "smf.readTemps()";
                return(portE);
            }

            return(null);
        }

        function loadPortF(sensor)
        {
            var portF = 'BoardID + " F " + ';

            /*if(sensor === )
            {
                portF += "smf.function()";
                return(portF);
            }*/

            return(null);
        }

    </script>

</html>
